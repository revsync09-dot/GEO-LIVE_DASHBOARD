<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GeoLive Settings</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="config.js"></script>
</head>
<body class="page settings">
  <div class="bg-grid"></div>
  <aside class="sidebar">
    <button class="sidebar-logo glow-target" type="button" aria-label="GeoLive">
      <img src="assets/logo.png" alt="GeoLive logo" />
    </button>
    <nav class="sidebar-nav">
      <a class="side-link" href="dashboard.html" aria-label="Dashboard">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <rect x="3" y="3" width="7" height="7" rx="2"></rect>
          <rect x="14" y="3" width="7" height="7" rx="2"></rect>
          <rect x="3" y="14" width="7" height="7" rx="2"></rect>
          <rect x="14" y="14" width="7" height="7" rx="2"></rect>
        </svg>
      </a>
      <a class="side-link" href="dashboard.html#servers" aria-label="Servers">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <rect x="4" y="4" width="16" height="6" rx="3"></rect>
          <rect x="4" y="14" width="16" height="6" rx="3"></rect>
          <circle cx="8" cy="7" r="1"></circle>
          <circle cx="8" cy="17" r="1"></circle>
        </svg>
      </a>
    </nav>
    <div class="sidebar-avatar glow-target">
      <img src="assets/logo.png" alt="User avatar" data-user-avatar />
    </div>
    <button class="side-link logout" id="logoutBtn" type="button" aria-label="Logout">
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M14 7l5 5-5 5"></path>
        <path d="M19 12H9"></path>
        <path d="M5 4h4v16H5"></path>
      </svg>
    </button>
  </aside>

  <main class="content">
    <header class="settings-hero">
      <h1>Settings</h1>
      <p class="subtext">Configure your dashboard experience and widget preferences.</p>
    </header>

    <section class="settings-section panel" id="section-widgets" data-section="widgets">
      <div class="section-head">
        <div class="section-title">
          <span class="section-icon glow-target teal" aria-hidden="true">
            <svg viewBox="0 0 24 24">
              <rect x="3" y="3" width="8" height="8" rx="2"></rect>
              <rect x="13" y="3" width="8" height="8" rx="2"></rect>
              <rect x="3" y="13" width="8" height="8" rx="2"></rect>
              <rect x="13" y="13" width="8" height="8" rx="2"></rect>
            </svg>
          </span>
          <span>Widget Visibility</span>
        </div>
      </div>
      <div class="toggle-grid">
        <div class="toggle-card">
          <div class="toggle-info">
            <span class="toggle-icon">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M12 3a3 3 0 0 0-3 3v7a4 4 0 1 0 6 0V6a3 3 0 0 0-3-3z"></path>
              </svg>
            </span>
            <div>
              <div class="toggle-title">Local Weather</div>
              <div class="toggle-subtext">Temperature, wind, humidity</div>
            </div>
          </div>
          <label class="switch">
            <input type="checkbox" id="toggleWeather" />
            <span class="switch-track"></span>
          </label>
        </div>

        <div class="toggle-card">
          <div class="toggle-info">
            <span class="toggle-icon">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M4 14c2-2 4-4 8-4s6 2 8 4"></path>
                <path d="M6 18c2-2 4-3 6-3s4 1 6 3"></path>
              </svg>
            </span>
            <div>
              <div class="toggle-title">Earthquake Feed</div>
              <div class="toggle-subtext">Recent seismic activity</div>
            </div>
          </div>
          <label class="switch">
            <input type="checkbox" id="toggleEarthquake" />
            <span class="switch-track"></span>
          </label>
        </div>

        <div class="toggle-card">
          <div class="toggle-info">
            <span class="toggle-icon">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <circle cx="12" cy="12" r="4"></circle>
                <path d="M12 2v3"></path>
                <path d="M12 19v3"></path>
                <path d="M2 12h3"></path>
                <path d="M19 12h3"></path>
              </svg>
            </span>
            <div>
              <div class="toggle-title">ISS Tracker</div>
              <div class="toggle-subtext">Live orbital position</div>
            </div>
          </div>
          <label class="switch">
            <input type="checkbox" id="toggleISS" />
            <span class="switch-track"></span>
          </label>
        </div>

        <div class="toggle-card">
          <div class="toggle-info">
            <span class="toggle-icon">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M3 15c2-4 6-6 9-6s7 2 9 6"></path>
                <path d="M6 18c1.5-3 4-4.5 6-4.5S16.5 15 18 18"></path>
              </svg>
            </span>
            <div>
              <div class="toggle-title">Aurora Forecast</div>
              <div class="toggle-subtext">KP index activity</div>
            </div>
          </div>
          <label class="switch">
            <input type="checkbox" id="toggleAurora" />
            <span class="switch-track"></span>
          </label>
        </div>
      </div>
    </section>

    <section class="settings-section panel" id="section-refresh" data-section="refresh">
      <div class="section-head">
        <div class="section-title">
          <span class="section-icon glow-target" aria-hidden="true">
            <svg viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="9"></circle>
              <path d="M12 7v5l3 2"></path>
            </svg>
          </span>
          <span>Data Refresh</span>
        </div>
        <div class="interval-display"><span id="intervalValue">25</span> minutes</div>
      </div>
      <div class="slider-panel">
        <input class="range" type="range" id="refreshRange" min="5" max="60" step="1" />
        <p class="subtext">Lower intervals provide more accuracy but consume more data bandwidth.</p>
      </div>
    </section>

    <section class="settings-section panel" id="section-appearance" data-section="appearance">
      <div class="section-head">
        <div class="section-title">
          <span class="section-icon glow-target" aria-hidden="true">
            <svg viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="9"></circle>
              <path d="M12 3a9 9 0 0 0 0 18"></path>
            </svg>
          </span>
          <span>Appearance</span>
        </div>
      </div>
      <div class="appearance-grid">
        <div class="accent-row">
          <span class="subtext">Accent Color</span>
          <div class="pill-row">
            <button class="accent-pill" type="button" data-color="#f2f2f2" style="--pill-color: #f2f2f2" aria-label="Bright white accent"></button>
            <button class="accent-pill" type="button" data-color="#d9d9d9" style="--pill-color: #d9d9d9" aria-label="Light gray accent"></button>
            <button class="accent-pill" type="button" data-color="#bfbfbf" style="--pill-color: #bfbfbf" aria-label="Soft gray accent"></button>
            <button class="accent-pill" type="button" data-color="#7a7a7a" style="--pill-color: #7a7a7a" aria-label="Graphite accent"></button>
          </div>
        </div>
        <label class="input-wrap">
          <span class="subtext">Banner URL</span>
          <input type="url" id="bannerUrl" placeholder="https://..." />
        </label>
      </div>
    </section>

    <section class="settings-section panel" id="section-commands" data-section="commands">
      <div class="section-head">
        <div class="section-title">
          <span class="section-icon glow-target purple" aria-hidden="true">
            <svg viewBox="0 0 24 24">
              <path d="M4 7l6 5-6 5"></path>
              <path d="M12 17h8"></path>
            </svg>
          </span>
          <span>Bot Commands</span>
        </div>
      </div>
      <div class="toggle-grid">
        <div class="toggle-card">
          <div class="toggle-info">
            <span class="toggle-icon">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M12 3a3 3 0 0 0-3 3v7a4 4 0 1 0 6 0V6a3 3 0 0 0-3-3z"></path>
              </svg>
            </span>
            <div>
              <div class="toggle-title">Weather Commands</div>
              <div class="toggle-subtext">/weather, forecasts, alerts</div>
            </div>
          </div>
          <label class="switch">
            <input type="checkbox" id="toggleWeatherCmd" />
            <span class="switch-track"></span>
          </label>
        </div>

        <div class="toggle-card">
          <div class="toggle-info">
            <span class="toggle-icon">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <circle cx="12" cy="12" r="4"></circle>
                <path d="M12 2v3"></path>
                <path d="M12 19v3"></path>
                <path d="M2 12h3"></path>
                <path d="M19 12h3"></path>
              </svg>
            </span>
            <div>
              <div class="toggle-title">Space Commands</div>
              <div class="toggle-subtext">ISS, orbits, celestial data</div>
            </div>
          </div>
          <label class="switch">
            <input type="checkbox" id="toggleSpaceCmd" />
            <span class="switch-track"></span>
          </label>
        </div>

        <div class="toggle-card">
          <div class="toggle-info">
            <span class="toggle-icon">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M4 14c2-2 4-4 8-4s6 2 8 4"></path>
                <path d="M6 18c2-2 4-3 6-3s4 1 6 3"></path>
              </svg>
            </span>
            <div>
              <div class="toggle-title">Disaster Commands</div>
              <div class="toggle-subtext">Earthquake and alert tools</div>
            </div>
          </div>
          <label class="switch">
            <input type="checkbox" id="toggleDisasterCmd" />
            <span class="switch-track"></span>
          </label>
        </div>

        <div class="toggle-card">
          <div class="toggle-info">
            <span class="toggle-icon">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M4 12h16"></path>
                <path d="M4 6h16"></path>
                <path d="M4 18h16"></path>
              </svg>
            </span>
            <div>
              <div class="toggle-title">Auto Feed</div>
              <div class="toggle-subtext">Automatic live updates</div>
            </div>
          </div>
          <label class="switch">
            <input type="checkbox" id="toggleAutoFeed" />
            <span class="switch-track"></span>
          </label>
        </div>
      </div>

      <div class="command-output">
        <div>
          <div class="toggle-title">Command Output</div>
          <div class="toggle-subtext">Choose how the bot replies to commands.</div>
        </div>
        <div class="output-options" role="radiogroup" aria-label="Command output">
          <label class="output-pill" data-value="embed">
            <input type="radio" name="commandOutput" value="embed" />
            <span class="output-label">Embed</span>
            <span class="output-subtext">Rich card response</span>
          </label>
          <label class="output-pill" data-value="graph">
            <input type="radio" name="commandOutput" value="graph" />
            <span class="output-label">Graph</span>
            <span class="output-subtext">Graph only</span>
          </label>
        </div>
      </div>
    </section>

    <div class="save-status" id="saveStatus"></div>
  </main>

  <script type="module">
    import { ensureAuthenticated, hydrateUserBadge, initGlow, logout } from './app.js';
    import { handleOAuthRedirect } from './oauth.js';
    import { initSettings } from './settings.js';

    (async () => {
      await handleOAuthRedirect();
      ensureAuthenticated();
      initGlow();
      hydrateUserBadge();
      initSettings();

      document.getElementById('logoutBtn').addEventListener('click', logout);
    })();
  </script>
</body>
</html>
